# ğŸŒAverage-Load-in-Linux

## ì‹œìŠ¤í…œì—ì„œ ì‘ë‹µ ì§€ì—°ê³¼ ì„±ëŠ¥ ì €í•˜ í˜„ìƒì´ ë°œìƒí•´, <br> ê·¸ ì›ì¸ì„ íŒŒì•…í•˜ê³  í•´ê²°í•  í•„ìš”ì„±ì„ ëŠê»´ load averageì™€ CPU ì‚¬ìš©ë¥ ì˜ ìƒê´€ê´€ê³„ë¥¼ ë¶„ì„í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê³  <br> ì´ë¥¼ í†µí•´ ë¶€í•˜ì˜ ì£¼ìš”ì›ì¸ì´ ë¬´ì—‡ì¸ì§€ ì •í™•íˆ íŒŒì•… ë° ì„±ëŠ¥ ê°œì„ ì„ ìœ„í•œ êµ¬ì²´ì ì¸ ë°©ì•ˆì„ ë§ˆë ¨í•˜ê³ ì í•¨

![image](https://github.com/user-attachments/assets/3e10cfc3-ea5a-40a0-abb6-8a2ef3523998)

Linux uptime ëª…ë ¹ì–´ì˜ ì˜ë¯¸
```
12:23:46      //current time
up 3:15       //system uptime
4 users       //number of logged-in users
load average  //1ë¶„, 5ë¶„, 15ë¶„ ë™ì•ˆì˜ í‰ê·  ë¶€í•˜
```
ì§€ë‚œ 1ë¶„ë™ì•ˆì˜ avrage load, ì§€ë‚œ 5ë¶„ë™ì•ˆì˜ avrage load, ì§€ë‚œ 15ë¶„ë™ì•ˆì˜ avrage load

### average load
ë‹¨ìœ„ ì‹œê°„ ë™ì•ˆ ì‹¤í–‰ ê°€ëŠ¥ ë˜ëŠ” ì¤‘ë‹¨ ë¶ˆê°€ëŠ¥í•œ ìƒíƒœì˜ í”„ë¡œì„¸ìŠ¤ì˜ í‰ê·  ìˆ˜
ì´ëŠ” í™œì„± í”„ë¡œì„¸ìŠ¤ì˜ í‰ê·  ìˆ˜ë¼ê³ ë„ í•˜ë©° CPU ì‚¬ìš©ë¥ ê³¼ ì§ì ‘ì ì¸ ê´€ë ¨ì´ ì—†ë‹¤
<br>
ë‹¨ìœ„ ì‹œê°„ë‹¹ CPU ì‚¬ìš©ë¥  ì´ë¼ê³  ìƒê°í•  ìˆ˜ ìˆê³ 
ë¶€í•˜ í‰ê·  0.12ì€ CPU ì‚¬ìš©ë¥  12%ë¥¼ ì˜ë¯¸ë¼ê³  ìƒê°í–ˆì§€ë§Œ ê·¸ë ‡ì§€ ì•Šë‹¤

### Runnable processes
CPUë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ CPU timeì„ ê¸°ë‹¤ë¦¬ëŠ” í”„ë¡œì„¸ìŠ¤
ps ëª…ë ¹ì–´ì—ì„œ Running ë˜ëŠ” Runnableë¡œ í‘œì‹œ

### Uninterruptible processes
ì‹œìŠ¤í…œì´ í”„ë¡œì„¸ìŠ¤ì™€ í•˜ë“œì›¨ì–´ ì¥ì¹˜ë¥¼ ë³´í˜¸í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜
í•˜ë“œì›¨ì–´ ì¥ì¹˜ì˜ I/O ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ëŠ” í”„ë¡œì„¸ìŠ¤ë¡œ ì¤‘ìš”í•œ ì»¤ë„ í”„ë¡œì„¸ìŠ¤ì— ì†í•˜ë©° ì¤‘ë‹¨ë  ìˆ˜ ì—†ëŠ” í”„ë¡œì„¸ìŠ¤
Uninterruptible Sleep ë˜ëŠ” Disk Sleepë¡œ í‘œì‹œ
<br>
í”„ë¡œì„¸ìŠ¤ê°€ ë””ìŠ¤í¬ì—ì„œ ë°ì´í„°ë¥¼ ì½ê±°ë‚˜ ì“¸ ë•Œ, ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ì¥í•˜ê¸° ìœ„í•´
ë””ìŠ¤í¬ì—ì„œ ì‘ë‹µì„ ë°›ì„ ë•Œê¹Œì§€ ì¤‘ë‹¨ë  ìˆ˜ ì—†ë‹¤
ë§Œì•½, í”„ë¡œì„¸ìŠ¤ê°€ ì¤‘ë‹¨ë˜ë©´ ë””ìŠ¤í¬ì™€ í”„ë¡œì„¸ìŠ¤ ê°„ì˜ ë°ì´í„°ê°€ ì¼ê´€ë˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤

### average load=2 ì˜ ì˜ë¯¸
2ê°œì˜ CPUê°€ ìˆëŠ” ì‹œìŠ¤í…œì—ì„œ ëª¨ë“  CPUê°€ ì‚¬ìš©ì¤‘ì´ë‹¤
<br>
4ê°œì˜ CPUê°€ ìˆëŠ” ì‹œìŠ¤í…œì—ì„œëŠ” 50%ì˜ ìœ íœ´ CPU ìš©ëŸ‰ì´ ìˆë‹¤
<br>
1ê°œì˜ CPUê°€ ìˆëŠ” ì‹œìŠ¤í…œì—ì„œ í”„ë¡œì„¸ìŠ¤ì˜ ì ˆë°˜ì´ CPU timeì„ ë†“ê³  ê²½ìŸ ì¤‘ì´ë‹¤

### ì ì ˆí•œ avrage load
ì´ìƒì ì¸ ìƒí™©ì€ average load = CPUì˜ ê°œìˆ˜
<br>
ì‹œìŠ¤í…œì— CPU ê°œìˆ˜ë¥¼ ì•Œì•„ë‚´ëŠ” ë²•
```
grep 'model name' /proc/cpuinfo | wc -l
```

![image](https://github.com/user-attachments/assets/138ccaca-c595-4b64-a699-f234a4006543)

### Average load vs. CPU usage
Average loadëŠ” ì‹œìŠ¤í…œì˜ ë¶€í•˜ë¥¼ ëŒ€ê¸° ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì˜ ìˆ˜ë¡œ ì¸¡ì •í•˜ë©°, CPUê°€ ì¼ì„ ì–¼ë§ˆë‚˜ í•  ìˆ˜ ìˆëŠ”ì§€ì™€ ê´€ë ¨ì´ ìˆë‹¤
CPU UsageëŠ” CPUê°€ í˜„ì¬ ì–¼ë§ˆë‚˜ ë°”ìœì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤

## average load ì´í•´ë¥¼ ìœ„í•œ test
### iostat, mpstat, pidstat ëª…ë ¹ì–´ë¥¼ í†µí•´ average load ì¦ê°€ ì›ì¸ íŒŒì•…
ëª…ë ¹ì–´ ì‚¬ìš©ì„ ìœ„í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
```
apt install stress sysstat
```
mpstatëŠ” ë©€í‹°ì½”ì–´ CPU ì„±ëŠ¥ì„ ë¶„ì„í•˜ëŠ” ë° ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë„êµ¬ë¡œ, ê° CPUì— ëŒ€í•œ ì‹¤ì‹œê°„ ì„±ëŠ¥ ì§€í‘œì™€ ëª¨ë“  CPUì— ëŒ€í•œ í‰ê·  ì§€í‘œë¥¼ ë³´ëŠ” ë° ì‚¬ìš©
<br>
pidstatëŠ” í”„ë¡œì„¸ìŠ¤ ì„±ëŠ¥ì„ ë¶„ì„í•˜ëŠ” ë° ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë„êµ¬ë¡œ, í”„ë¡œì„¸ìŠ¤ì˜ CPU, ë©”ëª¨ë¦¬, I/O, ì»¨í…ìŠ¤íŠ¸ ì „í™˜ì— ëŒ€í•œ ì‹¤ì‹œê°„ ì„±ëŠ¥ ì§€í‘œë¥¼ í™•ì¸í•˜ëŠ” ë° ì‚¬ìš©
<br>

![image](https://github.com/user-attachments/assets/ad083c49-ea0c-44c2-9bfc-d775d95794ff)

<br>
root ì‚¬ìš©ìë¡œ ì „í™˜

```
sudo su root
```

## CPU-intensive process
### 1. ë¶€í•˜ë¥¼ ì£¼ê¸°ìœ„í•œ stress ëª…ë ¹ì–´
ì²« ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰
```
stress --cpu 1 --timeout 600
```

![image](https://github.com/user-attachments/assets/c559326d-cb46-4ada-a309-fae7ef089e9b)

### 2. average loadì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ê¸° ìœ„í•œ uptime ëª…ë ¹ì–´
ë‘ ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰
```
watch -d uptime
```

![image](https://github.com/user-attachments/assets/5858f20a-5c4a-44a6-be22-4826edebe75e)

### 3. CPU ì‚¬ìš©ëŸ‰ì˜ ë³€í™”ë¥¼ ì‚´í´ë³´ê¸° ìœ„í•œ mpstat ëª…ë ¹ì–´
ì„¸ ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰
```
mpstat -P ALL 5
```

![image](https://github.com/user-attachments/assets/5c214020-c599-4d3d-9265-33afeaa5d307)

ë‘ ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ uptime ìœ¼ë¡œëŠ” average loadê°€ 1.00ìœ¼ë¡œ ì ì  ì¦ê°€í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆê³ 
<br>
ì„¸ ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ mpstat ë¡œëŠ” CPU ì‚¬ìš©ëŸ‰ì´ 100%ì— ê°€ê¹ê³  iowaitê°€ 0ì— ê°€ê¹Œìš´ ê²ƒì„ í™•ì¸ ê°€ëŠ¥
<br>
ê·¸ë ‡ë‹¤ë©´ ì–´ë–¤ í”„ë¡œì„¸ìŠ¤ê°€ CPU ì‚¬ìš©ëŸ‰ì„ 100%ë¡œ ë§Œë“¤ê³  ìˆëŠ”ì§€ pidstatë¡œ í™•ì¸
```
pidstat -u 5 1
```
![image](https://github.com/user-attachments/assets/54989a90-6d36-4cb8-97ca-bb7495c90b3e)

stress processì— ì˜í•´ ì¼ì–´ë‚¬ë‹¤ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥

##  I/O-intensive process
### 1. ë¶€í•˜ë¥¼ ì£¼ê¸°ìœ„í•œ stress ëª…ë ¹ì–´
ì²« ë²ˆì§¸ í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰
```
stress -i 1 --timeout 600
```
![image](https://github.com/user-attachments/assets/9da7093d-e0a4-4690-b973-0856527ad1da)
### 2. ì „ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ uptime, mpstat ì…ë ¥
load average ê°€ ë™ì¼í•˜ê²Œ 1.00 ì— ê·¼ì ‘í•˜ê²Œ ì˜¬ë¼ê°€ì§€ë§Œ
mpstatë¥¼ ì‚´í´ë³´ë©´ iowait ë¡œ ì¸í•´ CPU ì‚¬ìš©ëŸ‰ì´ ì¦ê°€í•˜ëŠ” ê²ƒì„ ì•Œìˆ˜ ìˆìŒ

![image](https://github.com/user-attachments/assets/7319f14e-4a7b-406c-8e3b-2ebd88b4c155)

## scenario with a large number of processes
### 1. í”„ë¡œì„¸ì˜ ê°œìˆ˜ë¥¼ 8ê°œë¡œ í•´ì„œ ë¶€í•˜ ë°œìƒ
```
stress -c 8 --timeout 600
```
![image](https://github.com/user-attachments/assets/fd73b779-fb9b-4913-a1cb-604849d1c1af)

### 2. load average
uptimeìœ¼ë¡œ load average í™•ì¸ ì‹œ 8ì— ê°€ê¹Œì›Œì§€ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥
![image](https://github.com/user-attachments/assets/d9d1f205-7d59-41cb-af52-bd3261448b5b)

### 3. pidstat ë¡œ í”„ë¡œì„¸ìŠ¤ ìƒí™© í™•ì¸

![image](https://github.com/user-attachments/assets/9788da3d-40a4-46b5-8ff7-9827d9bc66f9)

8ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ 2ê°œì˜ CPUë¥¼ ë†“ê³  ê²½ìŸ ì¤‘ì¸ ê²ƒì„ í™•ì¸ ê°€ëŠ¥

## ê²°ë¡ 
load average ë¥¼ í†µí•´ ì‹œìŠ¤í…œì˜ ì „ì²´ ì„±ëŠ¥ì„ ë¹ ë¥´ê²Œ í‰ê°€í•  ìˆ˜ ìˆì§€ë§Œ
<br>
load averageë§Œìœ¼ë¡œëŠ” ì–´ë””ì—ì„œ ë¶€í•˜ê°€ ë°œìƒí•˜ëŠ”ì§€ ì§ì ‘ í™•ì¸ ë¶ˆê°€ëŠ¥ 
ë”°ë¼ì„œ ì •í™•íˆ load averageë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ì„œëŠ” ì•„ë˜ 3ê°€ì§€ ì‚¬í•­ì„ ìœ ì˜í•´ì•¼ í•¨

#### 1. ë†’ì€ load averageëŠ” CPUë¥¼ ë§ì´ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¡œ ì¸í•´ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤
#### 2. ë†’ì€ load averageëŠ” ë°˜ë“œì‹œ CPU ì‚¬ìš©ë¥ ì´ ë†’ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤ I/O í™œë™ì´ ì¦ê°€í–ˆìŒì„ ë‚˜íƒ€ë‚¼ ìˆ˜ë„ ìˆë‹¤
#### 3. ë†’ì€ load averageê°€ ë°œê²¬ë˜ë©´ mpstat, pidstat ë“±ì˜ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€í•˜ì˜ ì›ì¸ì„ ë¶„ì„í•  ìˆ˜ ìˆë‹¤














